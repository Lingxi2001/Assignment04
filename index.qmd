---
title: "Data Science for Public Policy"
subtitle: "Assignment04"
author: "Lingxi Li - ll1188,
         Talia Stringfellow -tjs296"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

## Research question

BRICS country
2010-2018 year
how their electricity usage changed
- add something about the paris climate accord
- add something about why we are interested in BRICS
- add something about why electricy is interesting 

## Data resource

We refer to the energy data set from Our World In Data to analyze the question. The resource link is: <https://ourworldindata.org/explorers/energy>

Step1：Clean the data
```{r}
library(tidyverse)
data<-read_csv("data/energy_data.csv")
data<-data %>% 
  filter(country=="China"|country=="Brazil"|country=="Russia"|country=="India"|country=="South Africa",
    year>=2010 & year<=2018,
    !is.na(population),
    !is.na(gdp))
```

Graph 1:
BRICS's total electricity generation as share of primary energy between 2010 and 2018

```{r}
library(ggplot2)
data %>% 
  ggplot(aes(x = year, y= electricity_share_energy))+
  geom_line(aes(color=(country)),alpha=0.8,size=0.7)+
  scale_y_continuous(limit=c(10,23))+
  theme_minimal()+
  labs(x = "Year", y = "Electricity as Percent Share of Primary Energy \n(percentage point)", 
       title = "Total Electricity Generation for BRICS Countries",
       subtitle = "As Percentage Share of Total Primary Energy Consumption from 2010 to 2018",
       caption="")
```
This is a graphic of the total electricity generation as percentage share of 
direct primary energy consumption across BRICS nations from the year 2010 to 2018. 
In 2015, these countries signed the Paris Climate Accord and since you can see a 
steeper increase in Brazil, China, India. South Africa and Russia's share of 
electricity has remained consistent, though has dropped below 2010 shares in 2018. 

Graph 2:
BRICS electricity demand from 2010 to 2018

```{r}
data %>% 
ggplot(aes(x=country,y=electricity_demand))+
  geom_boxplot(aes(color=country),alpha=0.5)+
  theme_minimal()+
  theme(plot.caption = element_text(size = 6))+
  labs(x = "Country", y = "Electricity Demand \n (measured in terawatt-hours)", 
       title = "Electricy Demand for BRICS from 2010 to 2018",
       caption="'Energy use per person' - U.S. Energy Information Administration (2023) \n Energy Institute - Statistical Review of World Energy (2023) \n Population based on various sources (2023) via Our World Data \n OurWorldInData.org/energy")
```
This graph represents BRICS country absolute amount of electricity demand range 
between 2010 and 2018. China stands out with the largest electricity demand, with 
with the largest variance over the 18 year period. Brazil, Russia and South Africa
have almost no variance over the years and hover below 1000 terrewatts per hour.
Variance is noticable in India. Given that the two countries with highest variance 
are also the most populated, we hypothesize that population size affects Electricy
Demand variance. 

Graph 3:
BRICS's carbon intensity change between 2010 and 2018

```{r}
data %>% 
ggplot(aes(x = country, y = carbon_intensity_elec,fill = factor(year))) +
  geom_bar(stat = "identity", position = "dodge", alpha=0.7)+
  theme_minimal()+
  labs(x = "Country", 
       y = "Carbon Intensity of Electricity Generation", fill = "Year",
       title="Carbon Intensity of Electricity for BRICS from 2010 to 2018",
       subtitle="(Carbon intensity of Electricity Generation \n measuered in grams of CO2 equivalents per kilowatt-hour)") 

```
The Carbon Intensity of Electricity Generation is measured in grams of CO₂ equivalents per kilowatt-hour by country between the years of 2010 to 2018. The ten year range 
allows us to observe longterm change. Brazil reaches a peak in 2014 and we observe
a steady decline starting in 2015. In China, the peak is in 2011 followed by a steady decrease. 
This pattern is also observable in South Africa - the country with the largest 
carbon intensity, though with a less linear decline. Russia remains stagnant at
just below 400 grams of C0₂ equivalents per kilowatt-hour. Finally, India has a 
somewhat consistant, though rising, overall trend in CO₂ equivalents per kilowatt-hour.

Graph 4:
How BRICS's carbon intensity change with its electricity import from 2010 to 2018
```{r}
data %>% 
  group_by(country) %>% 
  ggplot(aes(x = year, y= net_elec_imports)) +
  geom_point(aes(size=carbon_intensity_elec,color=year),alpha=0.8) +
  geom_smooth(method="lm", se=F, size=0.5, color="black")+
  facet_wrap(~country)+
  labs(x = "Year", y = "Net Electrical Imports", 
       title = "Relationship between Carbon Intensity of Electricity Generation \n and Net Electrical Imports \n From 2010 to 2018",
       color = "Year") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5), 
        plot.margin = margin(t = 20, r = 0, b = 20, l = 20))+
  scale_size_continuous(name = "C02 Intensity \n of Elec Gen",range=c(1,12))
```
##I don't think we need year I excluded: facet_wrap(~country) +

Here we observe the relationship of net electricy imports on carbon intensity of 
electricity generation. As we expected, countries that export more than they 
export in electricity have lower carbon intesnity of electricity generation.
Brazil fluctuates below the 250 grams of CO₂ equivalents per kilowatt-hour carbon
intensity of electricity generation. ** NEED TO RECONSIDER THIS GRAPH* 
